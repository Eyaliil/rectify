<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rectify</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <!-- Landing Page View -->
        <div id="landing-view" class="view">
            <div class="container">
                <header>
                    <h1>Rectify</h1>
                    <p>Exercise Analysis & Quality Assessment</p>
                </header>
                
                <div class="landing-content">
                    <h2>Choose Your Workout Category</h2>
                    <div class="category-grid">
                        <div class="category-card" data-category="weightlifting">
                            <div class="category-icon">üèãÔ∏è</div>
                            <h3>Weight Lifting</h3>
                            <p>Build strength with proper form</p>
                        </div>
                        <div class="category-card" data-category="cardio">
                            <div class="category-icon">‚ù§Ô∏è</div>
                            <h3>Cardio</h3>
                            <p>Improve endurance and fitness</p>
                        </div>
                        <div class="category-card" data-category="yoga">
                            <div class="category-icon">üßò</div>
                            <h3>Yoga</h3>
                            <p>Enhance flexibility and balance</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Exercise Selection View -->
        <div id="exercise-view" class="view" style="display: none;">
            <div class="container">
                <header>
                    <h1>Rectify</h1>
                    <p>Select Your Exercise</p>
                </header>
                
                <div class="exercise-selection-content">
                    <button class="back-btn" id="back-to-categories">‚Üê Back to Categories</button>
                    <h2 id="category-title"></h2>
                    <div id="exercise-grid" class="exercise-grid"></div>
                </div>
            </div>
        </div>

        <!-- Analysis View -->
        <div id="analysis-view" class="view" style="display: none;">
            <div class="container">
                <header>
                    <h1>Rectify</h1>
                    <p>AI-Powered Exercise Analysis & Quality Assessment</p>
                </header>
                
                <button class="back-btn" id="back-to-exercises">‚Üê Back to Exercises</button>
                
                <div class="dashboard">
                    <!-- Main Panel -->
                    <div class="main-panel">
                        <!-- Visualizations Card -->
                        <div class="card">
                            <h3>3D Visualizations</h3>
                            <p class="card-description">Real-time body and spine analysis</p>
                            <div class="visualization-grid">
                                <div class="viz-container">
                                    <h3 class="viz-title">Exercise Demo</h3>
                                    <div class="exercise-video-panel">
                                        <video
                                            id="exercise-video"
                                            class="exercise-video"
                                            playsinline
                                            muted
                                            loop
                                            preload="metadata"
                                            controls
                                        ></video>
                                        <p id="exercise-video-placeholder" class="video-placeholder">
                                            Select an exercise to preview the movement.
                                        </p>
                                    </div>
                                </div>
                                <div class="viz-container">
                                    <h3 class="viz-title">Spine Visualization</h3>
                                    <div id="flextail-container"></div>
                                </div>
                            </div>
                            <div class="controls" style="margin-top: 20px;">
                                <button id="start-btn" class="btn btn-primary">Start Analysis</button>
                                <button id="stop-btn" class="btn btn-secondary" disabled>Stop</button>
                                <select id="exercise-select" class="exercise-select">
                                    <option value="auto">Auto-detect</option>
                                    <option value="squat">Squat</option>
                                    <option value="deadlift">Deadlift</option>
                                    <option value="plank">Plank</option>
                                    <option value="pushup">Push-up</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Side Panel -->
                    <div class="side-panel">
                        <!-- Sensor Connection Card -->
                        <div class="card">
                            <h3>Sensor Connection</h3>
                            <p class="card-description">Manage FlexTail hardware</p>
                            <div class="form-group">
                                <label for="sensor-mac">MAC Address (optional)</label>
                                <input id="sensor-mac" type="text" placeholder="AA:BB:CC:DD:EE:FF" />
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="sensor-hw">Hardware Version</label>
                                    <select id="sensor-hw">
                                        <option value="6.0">HW 6.0</option>
                                        <option value="5.0">HW 5.0</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="sensor-frequency">Frequency (Hz)</label>
                                    <input id="sensor-frequency" type="number" min="1" max="100" value="25" />
                                </div>
                            </div>
                            <div class="controls" style="margin-top: 12px;">
                                <button id="sensor-connect-btn" class="btn btn-primary">Connect</button>
                                <button id="sensor-disconnect-btn" class="btn btn-secondary">Disconnect</button>
                            </div>
                            <div class="controls" style="margin-top: 8px;">
                                <button id="sensor-start-btn" class="btn btn-primary">Start Streaming</button>
                                <button id="sensor-stop-btn" class="btn btn-secondary">Stop Streaming</button>
                            </div>
                            <div id="sensor-status" class="sensor-status">
                                <span class="status-dot status-disconnected"></span>
                                <span id="sensor-status-text">Disconnected</span>
                            </div>
                        </div>
                        <!-- Exercise Recognition Card -->
                        <div class="card">
                            <h3>Exercise Recognition</h3>
                            <p class="card-description">Detected exercise and confidence</p>
                            <div id="exercise-display" class="exercise-display">Waiting for data...</div>
                            <div id="confidence-display" class="confidence-display"></div>
                        </div>
                        
                        <!-- Form Analysis Card -->
                        <div class="card">
                            <h3>Real-Time Form Analysis</h3>
                            <p class="card-description">AI-powered feedback from FlexTail sensors</p>
                            
                            <!-- Form Score -->
                            <div class="metric" style="margin-bottom: 20px;">
                                <div class="metric-label">
                                    <span>Form Correctness</span>
                                    <span id="overall-score" class="metric-value">--</span>
                                </div>
                                <div class="progress-container">
                                    <div id="overall-progress" class="progress-bar" style="width: 0%"></div>
                                </div>
                            </div>
                            
                            <!-- Risk Level Indicator -->
                            <div id="risk-indicator" class="risk-indicator risk-safe" style="display: none;">
                                <div class="risk-content">
                                    <div class="risk-icon risk-icon-safe">
                                        <span style="color: white;">‚úì</span>
                                    </div>
                                    <div style="flex: 1;">
                                        <p style="font-size: 0.75rem; color: hsl(var(--muted-foreground)); margin-bottom: 4px;">Risk Level</p>
                                        <p style="font-weight: 600; color: hsl(var(--foreground));" id="risk-label">Safe</p>
                                    </div>
                                    <span id="risk-badge" class="badge badge-success">SAFE</span>
                                </div>
                            </div>
                            
                            <!-- Quality Metrics -->
                            <div class="metrics-container" style="margin-top: 20px;">
                                <div class="metric">
                                    <div class="metric-label">
                                        <span>Depth</span>
                                        <span id="depth-score" class="metric-value">--</span>
                                    </div>
                                    <div class="progress-container">
                                        <div id="depth-progress" class="progress-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                                <div class="metric">
                                    <div class="metric-label">
                                        <span>Stability</span>
                                        <span id="stability-score" class="metric-value">--</span>
                                    </div>
                                    <div class="progress-container">
                                        <div id="stability-progress" class="progress-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                                <div class="metric">
                                    <div class="metric-label">
                                        <span>Posture</span>
                                        <span id="posture-score" class="metric-value">--</span>
                                    </div>
                                    <div class="progress-container">
                                        <div id="posture-progress" class="progress-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                                <div class="metric">
                                    <div class="metric-label">
                                        <span>Symmetry</span>
                                        <span id="symmetry-score" class="metric-value">--</span>
                                    </div>
                                    <div class="progress-container">
                                        <div id="symmetry-progress" class="progress-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- AI Feedback Card -->
                        <div class="card">
                            <h3>AI Coach Feedback</h3>
                            <p class="card-description">Real-time guidance and corrections</p>
                            <div id="feedback-container" class="feedback-container">
                                <p class="feedback-placeholder">No feedback yet</p>
                            </div>
                        </div>
                        
                        <!-- Sensor Data Card -->
                        <div class="card">
                            <h3>Sensor Measurements</h3>
                            <p class="card-description">Live sensor data from FlexTail device</p>
                            <div id="sensor-data" class="sensor-data">
                                <div class="sensor-item">
                                    <span>Lumbar Lordosis</span>
                                    <span id="lordosis">--</span>
                                </div>
                                <div class="sensor-item">
                                    <span>Sagittal Tilt</span>
                                    <span id="sagittal">--</span>
                                </div>
                                <div class="sensor-item">
                                    <span>Lateral Tilt</span>
                                    <span id="lateral">--</span>
                                </div>
                                <div class="sensor-item">
                                    <span>Rotation</span>
                                    <span id="rotation">--</span>
                                </div>
                                <div class="sensor-item">
                                    <span>Acceleration</span>
                                    <span id="acceleration">--</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
    </div>
    
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.module.js",
            "three/examples/jsm/controls/OrbitControls.js": "https://cdn.jsdelivr.net/npm/three@0.158.0/examples/jsm/controls/OrbitControls.js"
        }
    }
    </script>
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <script type="module" src="navigation.js"></script>
    <script type="module" src="FlexTail3DViewer.js"></script>
    <script type="module" src="exerciseAnalyzer.js"></script>
    <script type="module" src="aiInterface.js"></script>
    <script type="module" src="main.js"></script>
    <script type="module" src="app.js"></script>
</body>
</html>
